This is proprietary code, from the original author. My changes are under whatever license he has. When I understand what that is, I'll update this.

Consider this NOT open source until then.
